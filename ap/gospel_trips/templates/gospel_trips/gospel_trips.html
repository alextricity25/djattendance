{% extends "base.html" %}
{% load staticfiles %}
{% load bootstrap3 %}
{% load common_tags %}
{% load render_bundle from webpack_loader %}

{% block title %}{{page_title}}{% endblock %}

{% block references %}
  <style type="text/css">

    .new-form{
      background-color: #b3ffcc;
    }

    .new-form textarea{
      background-color: #b3ffcc;
    }

    .new-form input{
      background-color: #b3ffcc;
    }

  </style>
{% endblock %}

{% block scripts %}
<script type="text/javascript">
  var AIRPORT_CODES = {{AIRPORT_CODES|safe}};
  var AIRLINE_CODES = {{AIRLINE_CODES|safe}};
  $(document).ready(function() {
    $(".airport-field").bind("input propertychange", function(){
      let check = AIRPORT_CODES.includes($(this).val());
      if (!check){
        $(this).css('border-color', 'red');
      }
      else {
        $(this).css('border-color', '');
      }
    });
    $(".airline-field").bind("input propertychange", function(){
      let check = AIRLINE_CODES.includes($(this).val());
      if (!check){
        $(this).css('border-color', 'red');
      }
      else {
        $(this).css('border-color', '');
      }
    });
  });

</script>
{% endblock %}

{% block content %}
<h2>{{page_title}}</h2>
{% if preview %}
<h3>Preview for: {{preview}}</h3>
{% endif %}
<form action="" method="post">
  {% csrf_token %}
  <div class="panel">
    {% for section in gospel_trip.section_set.all %}
      <h3>{{section.name}}</h3>
      {% for instruction in section.instruction_set.all %}
        <p>{{instruction.name}}</p>
        <p>{{instruction.instruction|safe}}</p>
      {% endfor %}
      {% for question in section.question_set.all %}
        <p>{{question.instruction|safe}}</p>
        {%for form in answer_forms %}
          {% if form.prefix == question.id %}
            {% bootstrap_form form %}
            {{form.media}}
          {% endif %}
        {% endfor %}
      {% endfor %}
    {% endfor%}
  </div>
  <div class="row">
    <div class="col-md-12">
      <button type="submit" class="btn btn-primary btn-save">Submit</button>
    </div>
  </div>
</form>
{% endblock %}
