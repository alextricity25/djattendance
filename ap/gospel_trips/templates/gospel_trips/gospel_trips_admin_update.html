{% extends "base.html" %}
{% load staticfiles %}
{% load bootstrap3 %}
{% load common_tags %}
{% load render_bundle from webpack_loader %} 

{% block title %}{{page_title}}{% endblock %}

{% block references %}
  {# {% render_bundle "tinymce" "css" %} #}
  <style type="text/css">
    .panel{
      background-color: #e0e0eb;
    }
    .panel textarea{
      background-color: #e0e0eb;
    }

    .panel input{
      background-color: #e0e0eb;
    }

    .new-form{
      background-color: #b3ffcc;
    }

    .new-form textarea{
      background-color: #b3ffcc;
    }

    .new-form input{
      background-color: #b3ffcc;
    }

  </style>
{% endblock %}


{% block scripts %}
  {# {% render_bundle "tinymce" "js" %} #}
  <script src="https://cloud.tinymce.com/stable/tinymce.min.js"></script>
  <script type="text/javascript">tinymce.init({ selector:'textarea' });</script>
  {{admin_form.media}}
{% endblock %}

{% block content %}
<h2>Gospel Trip Creator</h2>
<form action="" method="post">
  {% csrf_token %}
  
  {% bootstrap_form admin_form %}

<div class="section_formset">
  {{ section_formset.management_form }}
  {{ section_formset.non_form_errors }}
  {% for section_form in section_formset.forms %}
    <div class="panel {% if forloop.last %}new-form{% endif %}">
    <h3>{% if forloop.counter.last %} New {% endif %} Section</h3>

      {% bootstrap_form section_form %}

      {% for heading, nested_formset in section_form.nested.items %}
        {% if nested_formset %}
          {{ nested_formset.management_form }}
          {{ nested_formset.non_form_errors }}

          {% for nested_form in nested_formset.forms %}
            <h3>{% if forloop.counter.last %} New {% endif %} {{heading}}</h3>
            <div class="{% if forloop.counter.last %}new-form{% endif %}">
              {% bootstrap_form nested_form %}
            </div>
          {% endfor %}
        {% endif %}
      {% endfor %}
      </div>
  {% endfor %}
</div>

  
  <div class="row">
    <div class="col-md-12">
      <button type="submit" class="btn btn-primary btn-save">Submit</button>
    </div>
  </div>
</form>
{% endblock %}
